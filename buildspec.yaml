version: 0.2

phases:
  install:
    on-failure: ABORT
    runtime-versions:
       python: 3.8
    commands:
      - echo "Installing Flyway ..."
      - wget -qO- https://repo1.maven.org/maven2/org/flywaydb/flyway-commandline/6.5.3/flyway-commandline-6.5.3-linux-x64.tar.gz | tar xvz && ln -s `pwd`/flyway-6.5.3/flyway /usr/local/bin 
  build:
    on-failure: ABORT
    commands:
      - echo "Starting SAM packaging `date` in `pwd`"
      - flyway -enterprise migrate
  post_build:
    on-failure: ABORT
    commands:
      - echo "SAM packaging completed on `date` "
artifacts:
  files:
    ./